import React from 'react'
import ReactDOM from 'react-dom'

class App extends React.Component {
    constructor(props) {
        super(props)
        this.state = {
            hyva: 0,
            neutraali: 0,
            huono: 0,
            kaikki: []
        }
    }
    Lisaahyva = () => {
        this.setState({
            hyva: this.state.hyva + 1,
            kaikki: this.state.kaikki.concat(1)
        })
    }
    Lisaaneutraali = () => {
        this.setState({
            neutraali: this.state.neutraali +1,
            kaikki: this.state.kaikki.concat(0)
        })
    }
    Lisaahuono = () => {
        this.setState({
            huono: this.state.huono +1,
            kaikki: this.state.kaikki.concat(-1)
        })
    }


   
    render() {
        const keskiarvo = () =>
            
            this.state.kaikki.reduce(function (accumulator, currentvalue) 
                {
                    return (accumulator + currentvalue);
                }, 0)
            /this.state.kaikki.length; 
            

        const positiivisia = () => {
            var pos = this.state.kaikki.filter(function(obj){
                return obj === 1;
            })
            /*console.log(pos.length)*/
            return (pos.length/this.state.kaikki.length *100)
        }
        
        return(
            
            <div>
                <b>Anna palautetta</b>
                <p></p>
                
                <div>
                    <Button
                        clickevent={this.Lisaahyva}
                        text="Hyvä"
                    />
                    <Button
                        clickevent={this.Lisaaneutraali}
                        text="Neutraali"
                    />
                    <Button
                        clickevent={this.Lisaahuono}
                        text="Huono"
                    />
                </div>
                <p><b>Statistiikka</b></p>
               
                
                <div>
                    <Statistics
                        hyva={this.state.hyva}
                        neutraali={this.state.neutraali}
                        huono={this.state.huono}
                        keskiarvo={keskiarvo().toFixed(1)}
                        positiivisia={positiivisia().toFixed(1) + '%'}
                        kaikki={this.state.kaikki}
                    />
                </div>
            </div> 
        )
    }
}

 const Button = ({clickevent, text}) => (
    <button onClick={clickevent}>
        {text}
    </button>
   )
const Statistics = ({hyva, neutraali, huono, keskiarvo, positiivisia, kaikki}) => {
   if (kaikki.length === 0) {
       return(
        <em>ei palautetta</em>
       )
   }
    return(
    
        <div>
            <Statistic
            name={'Hyvä'}
            stat={hyva}
            />
            <Statistic
            name={'Neutraali'}
            stat={neutraali}
            />
            <Statistic
            name={'Huono'}
            stat={huono}
            />
            <Statistic
            name={'Keskiarvo'}
            stat={keskiarvo}
            />
            <Statistic
            name={'Positiivisia'}
            stat={positiivisia}
            />
        </div>
   )
}
const Statistic = ({name,stat}) => (<p>{name} {stat}</p>)


ReactDOM.render(<App />,document.getElementById('root')
)
