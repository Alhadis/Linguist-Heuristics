.TH K 7
.SH NAME
K \- Keyboard-focused desktop environment
.SH DESCRIPTION
.B K
is a Fedora installation based upon
.B Fedora
server, a keyboard-controlled
window manager and a collection of (mostly) command-line tools.
.PP
The primary concerns driving the choice of tools and configuration
are:
.RS
.PP
- minimization of "chrome",
.PP
- avoidance (but not elimination) of pointer devices,
.PP
- selection of lightweight, single-function tools where possible, and
.PP
- low resource usage, especially w.r.t. energy consumption.
.RE
.SH INSTALLATION
The
.B K-install
installer is to be run
.I immediately following
a fresh installation of
.B Fedora
server.
.RI ( "Not " workstation!)
.PP
The
.I ./K-install --install HOSTNAME
command should be run first; this installs additional 
packages from the Fedora, RPM Fusion and RPM Sphere repositories, sets
the computer's hostname and does some other system-level
configuration.
.PP
Next, look in
.BR K "'s " profiles
directory and adapt one of the existing profiles to your needs.
Then run
.IR "./K-install --user-setup PROFILE" .
.PP
Finally, peruse 
.BR K "'s " addons
directory to see additional tools that may be installed using
the 
.I ./K-install --addon ADDON ...
command.
.SH XS SHELL
The
.BR xs (1)
shell has different syntax than other shells. Full online documentation
is available via the
.I man xs
command.
.PP
The installation defines a number of utility and convenience commands as
.BR xs (1)
functions. Use the
.I luc
command to see a list.
Usage is displayed via the
.I help
command.
.PP
In addition to the utility and convenience commands, the
.B K
installation includes a library of
.BR xs (1)
functions which may be listed using the
.I lib
command and individually described using the
.I libi
command.
.BR xs (1)
function definitions may be inspected via the
.IR whats " and " pp
commands.
.SH LOGIN
There is no greeter in the 
.B K
installation. Rather, the user is logged in automatically to an
X session having a password-locked initial screen.
.PP
Linux consoles are accessed via
.IR Ctrl-Alt-F2 " through " Ctrl-Alt-F12 .
Return to the X session using
.IR Ctrl-Alt-F1 .
.SH WINDOW MANAGER
.PP
Hold the
.IR mod " key and press " return
to open a terminal.
.SH TERMINALS AND RELATED
These terminals (and related programs) are available:
.TP
.BR st (1)
A lightweight terminal. No scrollback. 256color and TrueColor support.
.TP
.BR dvtm (1)
A tiling terminal multiplexer. Similar to
.BR tmux (1),
but much simpler and without session support. Provides scrollback support.
.TP
.BR tabbed (1)
A container for Xembed clients. This can be used with
.BR st (1),
for example, to create a tabbed terminal.
.TP
.BR abduco (1)
A terminal session manager. Use this with
.BR st "(1) or " dvtm (1).
.PP
You may also work directly in the console if you log in on other than
.IR tty1 .
You have two options for a console terminal:
.TP
.B console
This is what you get when you log in to a tty. Unlike all of the other
tools listed in this section, the console is not Unicode-aware.
.TP
.BR yaft (1)
This uses the frame buffer to display text in a console session, providing
Unicode and 256-color support. The font size is hardcoded at build time and
is suitable for displays approximating 100 dpi.
.SH FILES
The 
.B K-install --user-setup
.I profile
command changes the user's shell to 
.BR xs (1),
restricts the set of 
.B XDG
directories and preconfigures certain programs as follows:
.TP
.I ~/.asoundrc
Configuration for the
.B ALSA
sound manager.
.TP
.I ~/bin/*
Miscellaneous utilities installed by
.BR K .
This directory may hold user-specific scripts and binaries
installed by other packages, as well.
.TP
.I ~/.cache/xslib/
Caches maintained by the
.BR xs (1)
user's library (as installed by
.BR K )
are kept here.
.TP
.I ~/.config/ncmpcpp/*
Configuration for the 
.BR ncmpcpp (1)
music player application.
.TP
.I ~/.config/xarrange
Configuration file associates pairs of xrandr outputs with an xrandr
command to arrange those outputs. This is effective only for non-mobile
devices (as determined from
.IR /sys/devices/virtual/dmi/id/chassis_type ).
.TP
.I ~/.config/xscale
The screen of a mobile device is closer to the operator than is the
screen of a desktop device.
The font-size calculation applied by the startup scripts assumes a
desktop device.
That font is perceived as being too large on a mobile device because
the reduced distance increases the angular size; the physical extent
of the font should be very similar as measured.
.RS
.PP
The
.I ~/.config/xscale
file is consulted only on a mobile device that is connected to only
one (presumably internal) display.
If the conditions are met and the file is present, the single
floating point number read from this file is used to scale the
calculated font size.
This number should be less than 1.0. A value of approximately 0.75
is typical.
If the file is missing or empty, the scale defaults to 1.0.
.RE
.TP
.I ~/.fetchmailrc
Fetchmail configuration used by
.I ~/.local/bin/frisbee
to check remote mail on behalf of
.BR xbiff (1).
.TP
.I ~/.inputrc
Configuration for GNU readline. These settings affect the
command line editing behavior of the
.BR xs (1)
shell.
.TP
.I ~/.local/noproxy
This file contains basic regular expressions (BRE), one per line, denoting
matches for web URLs that you want to access without the
.BR privoxy (1)
filtering proxy. This is effective only when the URL is opened using the
.B web-browser
command.
.TP
.I ~/.local/bin/*
Scripts and programs that are part of the K "infrastructure"
and not normally invoked from the command line.
.TP
.I ~/.mpd/*
Configuration for the
.BR mpd (1)
music player daemon.
.TP
.I ~/Music/
The 
.BR mpd (1)
music player daemon looks in this directory for music files.
.TP
.I ~/.taskrc
Configuration for the 
.BR task (1)
TODO list manager.
.TP
.I ~/.xbindkeysrc
Define key bindings for
.BR xbindkeys (1).
.TP
.I ~/.XCompose
Define additional composed key sequences.
.TP
.I ~/.xinitrc
Configuration for the window manager session. This script initiates services
and settings associated with the session, then starts the window manager.
.TP
.IR ~/.xlocktext ", " /etc/issue ", and " /etc/grub.d/000_issue
These files all contain texts asserting machine ownership or another
message derived from the
.B K
template for
.IR /etc/issue .
The
.I /etc/grub.d/000_issue
text is displayed by
.B GRUB
during system boot. The
.I /etc/issue
text is displayed during console login. The
.I ~/.xlocktext
text is displayed by xlock while prompting for an unlock password.
.TP
.IR ~/.Xresources " and " ~/.xsettingsd
These files declare (among other settings) the display resolution as
seen by the X server and GTK applications, respectively. Edit these
resolutions if you use a display that differs significantly from the
default 96ppi resolution.
.TP
.I ~/.xsin
The startup script for an
.BR xs (2)
interactive shell. If the shell is also a
login shell, this script runs after
.IR ~/.xsrc .
.TP
.I ~/.xsrc
The startup script for an
.BR xs (1)
login shell.
.TP
.IR ~/.xsrc.d/ " and " ~/.xslib.d/
Files in these directories are sourced by
.IR ~/.xsrc .
.TP
.I ~/.xsuser.d/
Files in this directory are sourced by
.IR ~/.xsin .
.TP
.I ~/.yapet
Configuration for the
.BR yapet (1)
password manager.
.PP
The 
.I /usr/local/share/doc/K/packages
directory contains lists by repository of packages installed by
.BR K .
Note that these lists do not include the packages installed by
.B anaconda
for the 
.B Fedora
server. The
.I /usr/local/share/doc/K
directory contains additional documentation.
.SH NOTES
.SS Displays
You're probably best off running this on at least a WXGA (1366x768;16:9)
display, although FHD (1920x1080;16:9) or UW-UXGA (2560x1080;21:9)
(or better) is preferred.
.PP
The range of usable display resolutions is constrained by GTK applications
that seem to not respect scaling as configured by
.BR xsettingsd (1).
Scaling for the terminal works over a wider range of display resolutions.
.PP
Use the
.IR ~/.Xresources " and " ~/.xsettingsd
files to configure other display resolutions. The
.I updres
command temporarily (until the window manager restarts) matches the
resolution to that reported by the primary display.
.PP
In the case of a second display attached to a mobile device, the
configuration automatically uses the external display rather than
the internal.
Use the
.BR xrandr (1)
command to enable, disable and arrange displays.
.PP
On a non-mobile device, only the first display is active by default.
A second display may be automatically enabled via a configuration entry
in
.IR ~/.config/xarrange .
Note that
.I ~/.config/xarrange
is consulted only for non-mobile devices.
.PP
Display connections may be changed at runtime. Connect the desired
display(s), then restart the X session using
.IR Ctrl-Alt-BackSpace .
.SS Netatop
The 
.BR netatop (4)
module is keyed to a particular kernel and must be recompiled
and installed for each new kernel version. Run the 
.I ~/.sources/netatop/remake
script. Note that the occasional kernel API change can break
.BR netatop (4)
and cause your kernel to misbehave. To recover, boot into an
earlier kernel version and run 
.IR "sudo systemctl disable netatop" ,
after which you will be able to boot into the latest kernel without
the issues caused by version skew between the kernel and
.BR netatop (4).
.SS Web
There really isn't a viable keyboard-driven web browser. Full stop.
.PP
The
.B falkon
browser, being an active project based upon the Blink engine, provides
reasonable compatibility with sites that expect Chromium or Firefox.
.PP
The
.BR surf (1)
web browser is provided for use inside
.BR tabbed (1),
since none of the mainstream browsers allow embedding.
.BR Surf (1)
has issues (due partly to the old WebKit library and partly to
design) that make it unsuitable for full-time use.
.SS Remake
Some of the programs built and installed from the 
.I ~/.sources
directory may benefit from periodic updates by their authors. Refer
to the documentation in the program's directory and to the original
.B K-install
installation script in order to preserve the program's configuration.
.SH SEE ALSO
.IR /usr/local/share/doc/K/ ,
.BR K-tools (7),
.BR K-workflow (7),
.BR xs (1),
.BR 2bwm (1),
.BR xbindkeys (1),
.BR dzen2 (1),
.BR st (1),
.BR dvtm (1),
.BR tabbed (1),
.BR abduco (1),
.BR privoxy (1),
.BR mpd (1),
.BR ncmpcpp (1),
.BR task (1),
.BR yapet (1),
.BR xrandr (1),
.BR netatop (4),
.BR falkon,
.BR surf (1)
.SH CONFORMING TO
.B K
sets up a working environment tailored to its author's preference.
.SH BUGS
The K installation scripts don't understand incremental updates.
If you want to keep up with changes you'll need to read the commit log and
apply deltas by hand.
.PP
The prompt manipulation functions assume that the terminal supports a certain
minimal subset of ANSI X3.64 control sequences and has proper
.BR terminfo (5)
support.
.SH AUTHORS
The 
.B K-install
installation scripts, the utility scripts in the 
.IR ~/bin ", " ~/.local/bin ", " ~/.xslib.d ", and " ~/.xsrc.d
directories, various configuration files, and the
.IR ~/.xinitrc ", " ~/.xsrc " and " ~/.xsin
files are written by David\~B.\ Lamkins.
.PP
The
.BR xs (1)
shell is maintained by David\~B.\ Lamkins.